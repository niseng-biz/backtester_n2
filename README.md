# ğŸ“ˆ æ ªå¼å–å¼•ãƒãƒƒã‚¯ãƒ†ã‚¹ã‚¿ãƒ¼

æ ªå¼ãƒ»ä»®æƒ³é€šè²¨å–å¼•æˆ¦ç•¥ã®ãŸã‚ã®é«˜æ€§èƒ½ã§æ‹¡å¼µå¯èƒ½ãªãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã€‚Python ã§æ§‹ç¯‰ã•ã‚Œã€LOT ãƒ™ãƒ¼ã‚¹ã®é«˜åº¦ãªãƒã‚¸ã‚·ãƒ§ãƒ³ã‚µã‚¤ã‚¸ãƒ³ã‚°ã€åŒ…æ‹¬çš„ãªãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹åˆ†æã€ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ãªå¯è¦–åŒ–æ©Ÿèƒ½ã‚’ç‰¹å¾´ã¨ã—ã¾ã™ã€‚

## âœ¨ ä¸»ãªæ©Ÿèƒ½

### ğŸš€ ã‚³ã‚¢ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆã‚¨ãƒ³ã‚¸ãƒ³
- **ãƒãƒ«ãƒã‚¢ã‚»ãƒƒãƒˆå¯¾å¿œ**: æ ªå¼ã€ä»®æƒ³é€šè²¨ã€ãã®ä»–ã®é‡‘èå•†å“
- **é«˜åº¦ãªæ³¨æ–‡ç®¡ç†**: æˆè¡Œæ³¨æ–‡ã€æŒ‡å€¤æ³¨æ–‡ï¼ˆã‚¹ãƒªãƒƒãƒšãƒ¼ã‚¸ãƒ»æ‰‹æ•°æ–™ãƒ¢ãƒ‡ãƒªãƒ³ã‚°ä»˜ãï¼‰
- **LOT ãƒ™ãƒ¼ã‚¹ãƒã‚¸ã‚·ãƒ§ãƒ³ã‚µã‚¤ã‚¸ãƒ³ã‚°**: FIXEDãƒ»VARIABLE ãƒ¢ãƒ¼ãƒ‰ã§ã®æŸ”è»Ÿãªãƒã‚¸ã‚·ãƒ§ãƒ³ã‚µã‚¤ã‚¸ãƒ³ã‚°
- **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªè¿½è·¡**: å®Œå…¨ãªãƒã‚¸ã‚·ãƒ§ãƒ³ãƒ»æç›Šãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°
- **ãƒªã‚¹ã‚¯ç®¡ç†**: ãƒã‚¸ã‚·ãƒ§ãƒ³åˆ¶é™ã€è³‡æœ¬åˆ¶ç´„ã€ãƒ‰ãƒ­ãƒ¼ãƒ€ã‚¦ãƒ³åˆ¶å¾¡

### ğŸ“Š ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹åˆ†æ
- **åŒ…æ‹¬çš„æŒ‡æ¨™**: ç·ãƒªã‚¿ãƒ¼ãƒ³ã€ã‚·ãƒ£ãƒ¼ãƒ—ãƒ¬ã‚·ã‚ªã€æœ€å¤§ãƒ‰ãƒ­ãƒ¼ãƒ€ã‚¦ãƒ³ã€å‹ç‡
- **é«˜åº¦ãªçµ±è¨ˆ**: ãƒ—ãƒ­ãƒ•ã‚£ãƒƒãƒˆãƒ•ã‚¡ã‚¯ã‚¿ãƒ¼ã€ã‚½ãƒ«ãƒ†ã‚£ãƒãƒ¬ã‚·ã‚ªã€ã‚«ãƒ«ãƒãƒ¼ãƒ¬ã‚·ã‚ªã€VaR è¨ˆç®—
- **å–å¼•åˆ†æ**: ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒ»ã‚¨ã‚°ã‚¸ãƒƒãƒˆè¿½è·¡ã‚’å«ã‚€è©³ç´°ãªå–å¼•å±¥æ­´
- **ãƒªã‚¹ã‚¯è©•ä¾¡**: ãƒ™ãƒ¼ã‚¿ã€ã‚¢ãƒ«ãƒ•ã‚¡ã€ã‚¤ãƒ³ãƒ•ã‚©ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¬ã‚·ã‚ªè¨ˆç®—

### ğŸ¨ ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«å¯è¦–åŒ–
- **ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãƒãƒ£ãƒ¼ãƒˆ**: ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒ»ã‚¨ã‚°ã‚¸ãƒƒãƒˆã‚·ã‚°ãƒŠãƒ«ä»˜ãä¾¡æ ¼ãƒãƒ£ãƒ¼ãƒˆ
- **è³‡ç”£æ›²ç·š**: æ™‚ç³»åˆ—ã§ã®ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªä¾¡å€¤æ¨ç§»
- **ãƒ‰ãƒ­ãƒ¼ãƒ€ã‚¦ãƒ³åˆ†æ**: ãƒ‰ãƒ­ãƒ¼ãƒ€ã‚¦ãƒ³æœŸé–“ã¨å›å¾©ã®è¦–è¦šåŒ–
- **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰**: å¤šç”»é¢åŒ…æ‹¬çš„æ¦‚è¦³
- **æˆ¦ç•¥æ¯”è¼ƒ**: ã‚µã‚¤ãƒ‰ãƒã‚¤ã‚µã‚¤ãƒ‰ã§ã®æˆ¦ç•¥ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹åˆ†æ

### ğŸ”§ æŠ€è¡“çš„å„ªç§€æ€§
- **ãƒ¢ã‚¸ãƒ¥ãƒ©ãƒ¼ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£**: æ‹¡å¼µå¯èƒ½ãªè¨­è¨ˆã§ã®é–¢å¿ƒäº‹ã®æ˜ç¢ºãªåˆ†é›¢
- **ã‚¿ã‚¤ãƒ—ã‚»ãƒ¼ãƒ•ãƒ†ã‚£**: ã‚ˆã‚Šä¿¡é ¼æ€§ã®é«˜ã„ã‚³ãƒ¼ãƒ‰ã®ãŸã‚ã®å®Œå…¨ãª Python å‹ãƒ’ãƒ³ãƒˆ
- **åŒ…æ‹¬çš„ãƒ†ã‚¹ãƒˆ**: 100+ ã®ãƒ¦ãƒ‹ãƒƒãƒˆãƒ»çµ±åˆãƒ†ã‚¹ãƒˆ
- **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–**: å¤§è¦æ¨¡ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®åŠ¹ç‡çš„å‡¦ç†
- **ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**: å®Œå…¨ãª API ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¨ä¾‹

## ğŸš€ ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ

### ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
# ãƒªãƒã‚¸ãƒˆãƒªã‚’ã‚¯ãƒ­ãƒ¼ãƒ³
git clone https://github.com/your-username/stock-trading-backtester.git
cd stock-trading-backtester

# ä»®æƒ³ç’°å¢ƒä½œæˆï¼ˆæ¨å¥¨ï¼‰
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate

# ä¾å­˜é–¢ä¿‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
pip install -r requirements.txt

# ãã®ä»–ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚ªãƒ—ã‚·ãƒ§ãƒ³
# é–‹ç™ºç’°å¢ƒ: pip install -r requirements/requirements-dev.txt
# è»½é‡ç‰ˆ: pip install -r requirements/requirements-minimal.txt
# æ ªå¼ãƒ‡ãƒ¼ã‚¿ã®ã¿: pip install -r requirements/stock_data_requirements.txt
```

### ğŸ“‹ Requirementsç®¡ç†

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã¯ç”¨é€”åˆ¥ã«è¤‡æ•°ã®requirementsãƒ•ã‚¡ã‚¤ãƒ«ã‚’æä¾›ã—ã¦ã„ã¾ã™ï¼š

- **`requirements.txt`**: ãƒ—ãƒ­ãƒ€ã‚¯ã‚·ãƒ§ãƒ³ç’°å¢ƒç”¨ï¼ˆãƒ¡ã‚¤ãƒ³ï¼‰
- **`requirements/requirements-dev.txt`**: é–‹ç™ºç’°å¢ƒç”¨ï¼ˆãƒ†ã‚¹ãƒˆãƒ»ã‚³ãƒ¼ãƒ‰å“è³ªãƒ„ãƒ¼ãƒ«å«ã‚€ï¼‰
- **`requirements/requirements-minimal.txt`**: è»½é‡ç‰ˆï¼ˆTA-Libãªã—ï¼‰
- **`requirements/stock_data_requirements.txt`**: æ ªå¼ãƒ‡ãƒ¼ã‚¿ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å°‚ç”¨

è©³ç´°ã¯ [`requirements/README.md`](requirements/README.md) ã‚’ã”è¦§ãã ã•ã„ã€‚

### ğŸ“Š æ ªä¾¡ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ©Ÿèƒ½

ã“ã®ãƒãƒƒã‚¯ãƒ†ã‚¹ã‚¿ãƒ¼ã«ã¯ã€Yahoo Financeã‹ã‚‰æ ªä¾¡ãƒ‡ãƒ¼ã‚¿ã‚’è‡ªå‹•å–å¾—ãƒ»ç®¡ç†ã™ã‚‹é«˜æ€§èƒ½ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚·ã‚¹ãƒ†ãƒ ãŒçµ±åˆã•ã‚Œã¦ã„ã¾ã™ã€‚

#### ğŸš€ curl_cffi ã«ã‚ˆã‚‹é«˜é€Ÿãƒ‡ãƒ¼ã‚¿å–å¾—ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰

- **2å€é«˜é€Ÿ**: å¾“æ¥ã®yfinanceãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚ˆã‚Š50%é«˜é€Ÿãªãƒªã‚¯ã‚¨ã‚¹ãƒˆå‡¦ç†
- **å¤§å®¹é‡ãƒãƒƒãƒ**: 20éŠ˜æŸ„ã®ä¸¦åˆ—å‡¦ç†ï¼ˆå¾“æ¥ã®10éŠ˜æŸ„ã‹ã‚‰å‘ä¸Šï¼‰
- **é«˜ã„æˆåŠŸç‡**: ãƒ–ãƒ©ã‚¦ã‚¶å½è£…ã«ã‚ˆã‚‹95%ã®æˆåŠŸç‡
- **å …ç‰¢ãªã‚¨ãƒ©ãƒ¼å‡¦ç†**: æŒ‡æ•°ãƒãƒƒã‚¯ã‚ªãƒ•ã«ã‚ˆã‚‹è‡ªå‹•ãƒªãƒˆãƒ©ã‚¤

#### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ©Ÿèƒ½

```python
from stock_database.utils.data_fetcher import DataFetcher
from stock_database.database import MongoDBManager

# é«˜æ€§èƒ½ãƒ‡ãƒ¼ã‚¿å–å¾—ï¼ˆcurl_cffiãŒãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰
data_fetcher = DataFetcher()

# è¤‡æ•°éŠ˜æŸ„ã®ä¸¦åˆ—å–å¾—
symbols = ['AAPL', 'GOOGL', 'MSFT', 'TSLA']
results = data_fetcher.fetch_stock_data(symbols)

# å·®åˆ†æ›´æ–°ï¼ˆæ–°ã—ã„ãƒ‡ãƒ¼ã‚¿ã®ã¿å–å¾—ï¼‰
incremental_results = data_fetcher.schedule_incremental_update(symbols)

# åŒ…æ‹¬çš„ãƒ‡ãƒ¼ã‚¿å–å¾—ï¼ˆæ ªä¾¡ãƒ»è²¡å‹™ãƒ»ä¼æ¥­æƒ…å ±ï¼‰
all_data = data_fetcher.fetch_all_data(symbols)
```

### åŸºæœ¬çš„ãªä½¿ç”¨æ–¹æ³•

```python
from backtester.crypto_data_reader import CryptoDataReader
from backtester.strategy import MovingAverageStrategy
from backtester.backtester import Backtester
from backtester.models import LotConfig, LotSizeMode

# ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆåˆæœŸåŒ–
data_reader = CryptoDataReader()
backtester = Backtester(initial_capital=100000)  # $100,000

# LOT ãƒ™ãƒ¼ã‚¹ãƒã‚¸ã‚·ãƒ§ãƒ³ã‚µã‚¤ã‚¸ãƒ³ã‚°è¨­å®š
lot_config = LotConfig(
    asset_type="crypto",
    lot_size_mode=LotSizeMode.VARIABLE,
    capital_percentage=0.8,  # åˆ©ç”¨å¯èƒ½è³‡æœ¬ã®80%ã‚’ä½¿ç”¨
    max_lot_size=10.0
)

# å–å¼•æˆ¦ç•¥ä½œæˆ
strategy = MovingAverageStrategy(
    short_window=10, 
    long_window=30,
    initial_capital=100000,
    lot_config=lot_config
)

# ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
result = backtester.run_backtest(
    data_reader, 
    strategy, 
    "data/BTCUSD_daily.csv"
)

# çµæœè¡¨ç¤º
print(f"ç·ãƒªã‚¿ãƒ¼ãƒ³: {result.total_return*100:.2f}%")
print(f"ã‚·ãƒ£ãƒ¼ãƒ—ãƒ¬ã‚·ã‚ª: {result.sharpe_ratio:.3f}")
print(f"æœ€å¤§ãƒ‰ãƒ­ãƒ¼ãƒ€ã‚¦ãƒ³: {result.max_drawdown*100:.2f}%")
print(f"å‹ç‡: {result.win_rate*100:.2f}%")
```

### ãƒ‡ãƒ¢å®Ÿè¡Œ

```bash
python examples/example_usage.py
# ã¾ãŸã¯
backtester-demo
```

### ğŸ“ Examples - ä½¿ç”¨ä¾‹é›†

`examples/` ãƒ•ã‚©ãƒ«ãƒ€ã«ã¯ã€æ§˜ã€…ãªä½¿ç”¨ä¾‹ã¨ãƒ‡ãƒ¢ãƒ³ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ï¼š

- **`example_usage.py`** â­ - ãƒ¡ã‚¤ãƒ³ãƒ‡ãƒ¢ï¼ˆå…¨æ©Ÿèƒ½ã®åŒ…æ‹¬çš„ãªä¾‹ï¼‰
- **`advanced_stock_dashboard.py`** - é«˜åº¦ãªæ ªå¼åˆ†æãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
- **`backtester_adapter_example.py`** - ã‚·ã‚¹ãƒ†ãƒ çµ±åˆã®ä¾‹
- **`data_access_api_example.py`** - ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹APIã®ä½¿ç”¨ä¾‹

è©³ç´°ã¯ [`examples/README.md`](examples/README.md) ã‚’ã”è¦§ãã ã•ã„ã€‚

ã“ã‚Œã¯ä»¥ä¸‹ã‚’å®Ÿæ¼”ã—ã¾ã™ï¼š
- ãƒã‚¤ã‚¢ãƒ³ãƒ‰ãƒ›ãƒ¼ãƒ«ãƒ‰æˆ¦ç•¥
- ç§»å‹•å¹³å‡ã‚¯ãƒ­ã‚¹ã‚ªãƒ¼ãƒãƒ¼æˆ¦ç•¥  
- RSI ãƒ™ãƒ¼ã‚¹ãƒ‰ãƒ«ã‚³ã‚¹ãƒˆå¹³å‡æ³•
- æˆ¦ç•¥æ¯”è¼ƒåˆ†æ
- ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«å¯è¦–åŒ–ç”Ÿæˆ

## ğŸ“Š å¯¾å¿œæˆ¦ç•¥

### çµ„ã¿è¾¼ã¿æˆ¦ç•¥

#### ãƒã‚¤ã‚¢ãƒ³ãƒ‰ãƒ›ãƒ¼ãƒ«ãƒ‰
```python
from backtester.strategy import BuyAndHoldStrategy

strategy = BuyAndHoldStrategy(
    initial_capital=100000,
    lot_config=lot_config
)
```

#### ç§»å‹•å¹³å‡ã‚¯ãƒ­ã‚¹ã‚ªãƒ¼ãƒãƒ¼
```python
from backtester.strategy import MovingAverageStrategy

strategy = MovingAverageStrategy(
    short_window=10,    # çŸ­æœŸMAæœŸé–“
    long_window=30,     # é•·æœŸMAæœŸé–“
    initial_capital=100000,
    lot_config=lot_config
)
```

#### RSI ãƒ‰ãƒ«ã‚³ã‚¹ãƒˆå¹³å‡æ³•
```python
from backtester.strategy import RSIAveragingStrategy

strategy = RSIAveragingStrategy(
    rsi_period=14,
    entry_levels=[20, 25, 30, 35, 40],  # è¤‡æ•°ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ
    exit_level=70,
    max_positions=5,
    initial_capital=100000,
    lot_config=lot_config
)
```

### ã‚«ã‚¹ã‚¿ãƒ æˆ¦ç•¥é–‹ç™º

```python
from backtester.strategy import Strategy
from backtester.models import Order, OrderType, OrderAction

class MyCustomStrategy(Strategy):
    def __init__(self, parameter1, parameter2, initial_capital, lot_config):
        super().__init__(initial_capital, "MyStrategy", lot_config)
        self.parameter1 = parameter1
        self.parameter2 = parameter2
    
    def generate_signal(self, current_data, historical_data):
        # å–å¼•ãƒ­ã‚¸ãƒƒã‚¯ã‚’å®Ÿè£…
        if self.should_buy(current_data, historical_data):
            lots = self.calculate_lot_size(self.cash, current_data.close, 1.0)
            return self.create_lot_order(
                action=OrderAction.BUY,
                lots=lots,
                current_price=current_data.close
            )
        elif self.should_sell(current_data, historical_data):
            current_lots = self.lot_config.units_to_lots(self.current_position)
            return self.create_lot_order(
                action=OrderAction.SELL,
                lots=current_lots,
                current_price=current_data.close
            )
        return None
    
    def get_strategy_name(self):
        return "My Custom Strategy"
```

## ğŸ¨ å¯è¦–åŒ–ä¾‹

### ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ãƒãƒ£ãƒ¼ãƒˆç”Ÿæˆ

```python
from backtester.visualization import VisualizationEngine

viz_engine = VisualizationEngine()

# ã‚·ã‚°ãƒŠãƒ«ä»˜ãä¾¡æ ¼ãƒãƒ£ãƒ¼ãƒˆ
fig = viz_engine.create_price_chart_with_signals(
    market_data, 
    trades,
    title="BTC/USD å–å¼•ã‚·ã‚°ãƒŠãƒ«",
    save_path="charts/btc_signals.png"
)

# è³‡ç”£æ›²ç·š
fig = viz_engine.create_equity_curve(
    portfolio_history,
    title="ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹",
    save_path="charts/equity_curve.png"
)

# ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
fig = viz_engine.create_performance_dashboard(
    backtester,
    market_data,
    strategy_name="ç§»å‹•å¹³å‡æˆ¦ç•¥",
    save_path="charts/dashboard.png"
)
```

### æˆ¦ç•¥æ¯”è¼ƒ

```python
# è¤‡æ•°æˆ¦ç•¥æ¯”è¼ƒ
strategies = [
    BuyAndHoldStrategy(100000, lot_config),
    MovingAverageStrategy(5, 20, 100000, lot_config),
    MovingAverageStrategy(10, 30, 100000, lot_config)
]

results = backtester.compare_strategies(strategies, data_reader, "data/BTCUSD.csv")

# æ¯”è¼ƒãƒãƒ£ãƒ¼ãƒˆç”Ÿæˆ
fig = viz_engine.compare_strategies_chart(
    results,
    metrics=['total_return', 'sharpe_ratio', 'max_drawdown', 'win_rate'],
    title="æˆ¦ç•¥ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ¯”è¼ƒ",
    save_path="charts/strategy_comparison.png"
)
```

## ğŸ“ ãƒ‡ãƒ¼ã‚¿å½¢å¼

### CSV ãƒ‡ãƒ¼ã‚¿è¦ä»¶

```csv
timestamp,open,high,low,close,volume
1640995200,46000.0,47500.0,45500.0,47000.0,1250
1641081600,47000.0,48200.0,46800.0,48100.0,1180
1641168000,48100.0,49000.0,47900.0,48800.0,1320
```

**å¿…é ˆåˆ—:**
- `timestamp`: Unix ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ã¾ãŸã¯æ—¥ä»˜æ–‡å­—åˆ—
- `open`: å§‹å€¤
- `high`: é«˜å€¤
- `low`: å®‰å€¤  
- `close`: çµ‚å€¤
- `volume`: å‡ºæ¥é«˜

### ã‚«ã‚¹ã‚¿ãƒ ãƒ‡ãƒ¼ã‚¿ãƒªãƒ¼ãƒ€ãƒ¼

```python
from backtester.data_reader import CSVDataReader

# ã‚«ã‚¹ã‚¿ãƒ åˆ—ãƒãƒƒãƒ”ãƒ³ã‚°
custom_reader = CSVDataReader(
    date_column='Date',
    open_column='O',
    high_column='H', 
    low_column='L',
    close_column='C',
    volume_column='Vol'
)
```

## âš™ï¸ é«˜åº¦ãªè¨­å®š

### LOT ãƒ™ãƒ¼ã‚¹ãƒã‚¸ã‚·ãƒ§ãƒ³ã‚µã‚¤ã‚¸ãƒ³ã‚°

```python
from backtester.models import LotConfig, LotSizeMode

# å¯å¤‰LOTã‚µã‚¤ã‚¸ãƒ³ã‚°ï¼ˆè³‡æœ¬ã®å‰²åˆï¼‰
variable_config = LotConfig(
    asset_type="crypto",
    lot_size_mode=LotSizeMode.VARIABLE,
    capital_percentage=0.8,  # åˆ©ç”¨å¯èƒ½è³‡æœ¬ã®80%ã‚’ä½¿ç”¨
    max_lot_size=10.0,
    min_lot_size=0.01
)

# å›ºå®šLOTã‚µã‚¤ã‚¸ãƒ³ã‚°ï¼ˆä¸€å®šLOTã‚µã‚¤ã‚ºï¼‰
fixed_config = LotConfig(
    asset_type="stock", 
    lot_size_mode=LotSizeMode.FIXED,
    base_lot_size=100,  # 1LOTã‚ãŸã‚Š100æ ª
    min_lot_size=0.01
)
```

### ãƒªã‚¹ã‚¯ç®¡ç†

```python
# ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªãƒªã‚¹ã‚¯åˆ¶é™
portfolio_manager.set_risk_limits(
    max_position_size=0.1,    # 1ãƒã‚¸ã‚·ãƒ§ãƒ³æœ€å¤§10%
    max_total_exposure=1.0    # ç·ã‚¨ã‚¯ã‚¹ãƒãƒ¼ã‚¸ãƒ£ãƒ¼æœ€å¤§100%
)

# æ³¨æ–‡åŸ·è¡Œã‚³ã‚¹ãƒˆ
order_manager.set_slippage(0.001)    # 0.1%ã‚¹ãƒªãƒƒãƒšãƒ¼ã‚¸
order_manager.set_commission(0.001)  # 0.1%æ‰‹æ•°æ–™
```

## ğŸ“Š ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æŒ‡æ¨™

### åŸºæœ¬æŒ‡æ¨™
- **ç·ãƒªã‚¿ãƒ¼ãƒ³**: `(æœ€çµ‚è³‡æœ¬ - åˆæœŸè³‡æœ¬) / åˆæœŸè³‡æœ¬`
- **å¹´ç‡ãƒªã‚¿ãƒ¼ãƒ³**: è¤‡åˆ©å¹´é–“æˆé•·ç‡
- **æœ€å¤§ãƒ‰ãƒ­ãƒ¼ãƒ€ã‚¦ãƒ³**: æœ€å¤§ã®ãƒ”ãƒ¼ã‚¯ã‹ã‚‰ãƒˆãƒ©ãƒ•ã¾ã§ã®ä¸‹è½
- **å‹ç‡**: åˆ©ç›Šã¨ãªã£ãŸå–å¼•ã®å‰²åˆ

### ãƒªã‚¹ã‚¯èª¿æ•´æŒ‡æ¨™
- **ã‚·ãƒ£ãƒ¼ãƒ—ãƒ¬ã‚·ã‚ª**: `(å¹³å‡ãƒªã‚¿ãƒ¼ãƒ³ - ãƒªã‚¹ã‚¯ãƒ•ãƒªãƒ¼ãƒ¬ãƒ¼ãƒˆ) / æ¨™æº–åå·®`
- **ã‚½ãƒ«ãƒ†ã‚£ãƒãƒ¬ã‚·ã‚ª**: ä¸‹æ–¹åå·®ã‚’ç”¨ã„ãŸã‚·ãƒ£ãƒ¼ãƒ—ãƒ¬ã‚·ã‚ª
- **ã‚«ãƒ«ãƒãƒ¼ãƒ¬ã‚·ã‚ª**: `å¹´ç‡ãƒªã‚¿ãƒ¼ãƒ³ / æœ€å¤§ãƒ‰ãƒ­ãƒ¼ãƒ€ã‚¦ãƒ³`
- **ã‚¤ãƒ³ãƒ•ã‚©ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¬ã‚·ã‚ª**: ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚¨ãƒ©ãƒ¼1å˜ä½ã‚ãŸã‚Šã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãƒªã‚¿ãƒ¼ãƒ³

### å–å¼•çµ±è¨ˆ
- **ãƒ—ãƒ­ãƒ•ã‚£ãƒƒãƒˆãƒ•ã‚¡ã‚¯ã‚¿ãƒ¼**: `ç·åˆ©ç›Š / ç·æå¤±`
- **å¹³å‡å‹æ•—**: å–å¼•ã‚ãŸã‚Šã®å¹³å‡åˆ©ç›Šãƒ»æå¤±
- **æœŸå¾…å€¤**: `(å‹ç‡ Ã— å¹³å‡å‹ã¡) + (è² ã‘ç‡ Ã— å¹³å‡è² ã‘)`
- **æœ€å¤§é€£ç¶šå‹æ•—**: æœ€é•·ã®é€£å‹ãƒ»é€£æ•—è¨˜éŒ²

## ğŸ§ª ãƒ†ã‚¹ãƒˆ

### ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ

```bash
# å…¨ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
pytest

# ç‰¹å®šãƒ†ã‚¹ãƒˆã‚«ãƒ†ã‚´ãƒªå®Ÿè¡Œ
pytest tests/unit/          # ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ
pytest tests/integration/   # çµ±åˆãƒ†ã‚¹ãƒˆ
pytest tests/examples/      # ä¾‹é¡Œãƒ†ã‚¹ãƒˆ

# ã‚«ãƒãƒ¬ãƒƒã‚¸ä»˜ãå®Ÿè¡Œ
pytest --cov=backtester tests/
```

### ãƒ†ã‚¹ãƒˆã‚«ãƒ†ã‚´ãƒª
- **ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ**: å€‹åˆ¥ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãƒ†ã‚¹ãƒˆ
- **çµ±åˆãƒ†ã‚¹ãƒˆ**: ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆé–“ç›¸äº’ä½œç”¨ãƒ†ã‚¹ãƒˆ  
- **ä¾‹é¡Œãƒ†ã‚¹ãƒˆ**: ã‚¨ãƒ³ãƒ‰ãƒ„ãƒ¼ã‚¨ãƒ³ãƒ‰ã‚·ãƒŠãƒªã‚ªãƒ†ã‚¹ãƒˆ

## ğŸ“¤ çµæœã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ

### JSON ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
```python
# å®Œå…¨çµæœã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
backtester.export_results("results.json", format="json")
```

### CSV ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
```python
# å–å¼•å±¥æ­´ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
backtester.export_results("trades.csv", format="csv")
```

### ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆãƒ‡ãƒ¼ã‚¿å†…å®¹
- å…¨æŒ‡æ¨™ã‚’å«ã‚€ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è¦ç´„
- ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒ»ã‚¨ã‚°ã‚¸ãƒƒãƒˆè©³ç´°ã‚’å«ã‚€å®Œå…¨å–å¼•å±¥æ­´
- ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªä¾¡å€¤æ¨ç§»
- æˆ¦ç•¥ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨è¨­å®š
- å®Ÿè¡Œãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã¨ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—

## ğŸ—ï¸ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆæ¦‚è¦

```
backtester/
â”œâ”€â”€ models.py              # ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«ï¼ˆMarketDataã€Tradeã€Orderç­‰ï¼‰
â”œâ”€â”€ data_reader.py         # ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ãƒ™ãƒ¼ã‚¹ã‚¯ãƒ©ã‚¹
â”œâ”€â”€ crypto_data_reader.py  # ä»®æƒ³é€šè²¨ãƒ‡ãƒ¼ã‚¿ãƒªãƒ¼ãƒ€ãƒ¼
â”œâ”€â”€ strategy.py            # æˆ¦ç•¥ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã¨å®Ÿè£…
â”œâ”€â”€ order_manager.py       # æ³¨æ–‡å®Ÿè¡Œãƒ»ç®¡ç†
â”œâ”€â”€ portfolio.py           # ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªãƒ»ãƒã‚¸ã‚·ãƒ§ãƒ³ç®¡ç†
â”œâ”€â”€ analytics.py           # ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹åˆ†æã‚¨ãƒ³ã‚¸ãƒ³
â”œâ”€â”€ backtester.py          # ãƒ¡ã‚¤ãƒ³ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆã‚¨ãƒ³ã‚¸ãƒ³
â”œâ”€â”€ visualization.py       # ãƒãƒ£ãƒ¼ãƒˆãƒ»å¯è¦–åŒ–ã‚¨ãƒ³ã‚¸ãƒ³
â””â”€â”€ result_manager.py      # çµæœã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆãƒ»ç®¡ç†
```

### è¨­è¨ˆåŸå‰‡
- **ãƒ¢ã‚¸ãƒ¥ãƒ©ãƒ¼è¨­è¨ˆ**: ç‹¬ç«‹ã—ãŸç–çµåˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
- **æ‹¡å¼µæ€§**: æ–°ã—ã„æˆ¦ç•¥ãƒ»ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã®ç°¡å˜è¿½åŠ 
- **ã‚¿ã‚¤ãƒ—ã‚»ãƒ¼ãƒ•ãƒ†ã‚£**: ä¿¡é ¼æ€§ã®ãŸã‚ã®åŒ…æ‹¬çš„å‹ãƒ’ãƒ³ãƒˆ
- **ãƒ†ã‚¹ãƒˆå¯èƒ½æ€§**: å„ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ç‹¬ç«‹ãƒ†ã‚¹ãƒˆ
- **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹**: å¤§è¦æ¨¡ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆå‡¦ç†æœ€é©åŒ–

## ğŸ” ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚ˆãã‚ã‚‹å•é¡Œ

#### ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼
```
FileNotFoundError: CSV file not found
```
**è§£æ±ºç­–**: ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã‚’ç¢ºèªã—ã€CSVå½¢å¼ãŒè¦ä»¶ã«ä¸€è‡´ã™ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚

#### ãƒ¡ãƒ¢ãƒªå•é¡Œ
```
MemoryError: Unable to allocate array
```
**è§£æ±ºç­–**: ã‚ˆã‚Šå°ã•ãªãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’ä½¿ç”¨ã™ã‚‹ã‹ã€å¤§ããªãƒ•ã‚¡ã‚¤ãƒ«ã«ã¯ãƒ‡ãƒ¼ã‚¿ãƒãƒ£ãƒ³ã‚¯ã‚’å®Ÿè£…ã—ã¦ãã ã•ã„ã€‚

#### å¯è¦–åŒ–è­¦å‘Š
```
UserWarning: Glyph missing from current font
```
**è§£æ±ºç­–**: æ—¥æœ¬èªãƒ•ã‚©ãƒ³ãƒˆè­¦å‘Š - ãƒãƒ£ãƒ¼ãƒˆã¯æ­£ã—ãç”Ÿæˆã•ã‚Œã¾ã™ã€‚

### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–

```python
# å¤§è¦æ¨¡ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®é€²æ—è¿½è·¡
backtester.set_progress_callback(
    lambda current, total: print(f"é€²æ—: {current/total*100:.1f}%")
)

# ãƒ¡ãƒ¢ãƒªç›£è¦–
import psutil
process = psutil.Process()
print(f"ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡: {process.memory_info().rss / 1024 / 1024:.1f} MB")
```

## ğŸ¤ è²¢çŒ®

è²¢çŒ®ã‚’æ­“è¿ã—ã¾ã™ï¼è©³ç´°ã¯[è²¢çŒ®ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³](CONTRIBUTING.md)ã‚’ã”è¦§ãã ã•ã„ã€‚

### é–‹ç™ºç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

```bash
# é–‹ç™ºç’°å¢ƒã®ã‚¯ãƒ­ãƒ¼ãƒ³ã¨ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
git clone https://github.com/your-username/stock-trading-backtester.git
cd stock-trading-backtester
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate
pip install -r requirements/requirements-dev.txt

# pre-commit ãƒ•ãƒƒã‚¯ ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
pre-commit install
```

### ã‚³ãƒ¼ãƒ‰æ¨™æº–
- **PEP 8**: Python ã‚¹ã‚¿ã‚¤ãƒ«ã‚¬ã‚¤ãƒ‰æº–æ‹ 
- **å‹ãƒ’ãƒ³ãƒˆ**: å…¨é–¢æ•°ã«å‹æ³¨é‡ˆå¿…é ˆ
- **ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**: åŒ…æ‹¬çš„ãª docstring å¿…é ˆ
- **ãƒ†ã‚¹ãƒˆ**: æ–°æ©Ÿèƒ½ã«ã¯ãƒ†ã‚¹ãƒˆã‚’å«ã‚ã‚‹

## ğŸ“„ ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ MIT ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®ä¸‹ã§ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã•ã‚Œã¦ã„ã¾ã™ - è©³ç´°ã¯ [LICENSE](LICENSE) ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã”è¦§ãã ã•ã„ã€‚
